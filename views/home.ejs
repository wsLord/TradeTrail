<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home TradeTrail</title>
    <link rel="stylesheet" href="/css/homeStyles.css">

</head>

<body>

    <!-- Include Navbar -->
    <div id="navbar">
        <%- include('./common/navigation.ejs') %>
    </div>

    <!-- Welcome Section -->
    <div class="welcome-section">
        <img src="/assets/logo.png" alt="TradeTrail Logo">
        <h1>Welcome to Trade<span style="color:#52694a ;">Trail</span></h1>
        <p>Swap, Sell, Rent, Repeat!</p>
    </div>

    <!-- About Us Section -->
    <section class="about-us">
        <h2>About Us</h2>
        <div class="abtus-container">
            TradeTrail is here to make sustainability simple and accessible. By embracing circular economy principles, we provide a platform for renting, reselling, and swapping goods and subscriptions. Our mission is to help people make eco-conscious choices while
            saving money and reducing waste. Join us in creating a more sustainable, connected future.
        </div>
    </section>

    <!-- Feature Sections -->
    <section class="feat-heading">
        <h2>Features</h2>
    </section>

    <% const features = [
        { image: "rent.jpg", title: "Renting Items", description: "Browse and rent items for all your needs—whether it’s home essentials, tech gadgets, or college supplies", link: "#" },
        { image: "subscription.jpg", title: "Subscription Swapping", description: "Swap subscriptions with ease—whether it's streaming services, e-books, or gym memberships", link: "#" },
        { image: "secondhand.jpg", title: "Second-Hand Chain Buying", description: "Find quality pre-owned items, and give them a new life while saving resources and money", link: "#" }
    ]; %>

        <% features.forEach(feature => { %>
            <section class="feature-section">
                <img src="/assets/<%= feature.image %>" alt="<%= feature.title %>">
                <div class="feature-content">
                    <h2>
                        <%= feature.title %>
                    </h2>
                    <p>
                        <%= feature.description %>
                    </p>
                    <!-- <button onclick="window.location.href='<%= feature.link %>'">Explore</button> -->
                    <% if (feature.title === "Renting Items") { %>
                        <button onclick="window.location.href='/rental'">Rent an Item</button>
                        <% } else if (feature.title === "Second-Hand Chain Buying") { %>
                            <button onclick="window.location.href='/secondHand'">Buy an Item</button>
                            <% } else { %>
                                <button onclick="window.location.href='/subscription'">Explore</button>
                                <% } %>
                </div>
            </section>
            <% }) %>

                <!-- CONTACT US SECTION -->
                <section class="contact-us">
                    <h2>Contact Us</h2>
                    <div class="contact-details">
                        <div class="phone">
                            <p><strong>Phone:</strong></p>
                            <ul>
                                <li>+91 123 456 7890</li>
                                <li>+91 987 654 3210</li>
                            </ul>
                        </div>
                        <div class="mail">
                            <p><strong>Email:</strong></p>
                            <ul>
                                <li>support@tradetrail.com</li>
                            </ul>
                        </div>
                    </div>
                </section>

                 <!-- Chatbot Container -->
                 <div class="chatbot-container">
                    <div class="chat-icon" onclick="toggleChat()" role="button" aria-label="Open chat" tabindex="0">
                        <svg viewBox="0 0 64 64">
                            <!-- Main chat bubble -->
                            <path class="chat-bubble" d="M12 12h40v30H28.86L12 50.86V12" rx="5" ry="5"/>
                            <!-- Chat lines -->
                            <g class="chat-lines">
                                <path d="M20 25h24"/>
                                <path d="M20 32h18"/>
                                <path d="M20 39h14"/>
                            </g>
                        </svg>
                    </div>
                    <div class="chatbot-interface" id="chatInterface">
                        <div class="chat-header">
                            <h3>TradeTrail Assistant</h3>
                            <button class="close-button" onclick="toggleChat()" aria-label="Close chat">
                                <svg class="close-icon" viewBox="0 0 24 24">
                                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                                </svg>
                            </button>
                        </div>
                        <div class="chat-messages" id="chatMessages">
                            <div class="message bot-message">
                                Hello! How can I help you today?
                            </div>
                        </div>
                        <div class="chat-input">
                            <input type="text" id="userInput" placeholder="Type your message...">
                            <button onclick="sendMessage()">Send</button>
                        </div>
                    </div>
    </div>

    <script>
        // Predefined responses
        const predefinedResponses = {
            "hello": "Hello! How can I assist you today?",
            "hi": "Hi there! How can I help?",
            "rent": "You can rent items by visiting our rental section. Check out the 'Renting Items' feature!",
            "subscription": "To swap subscriptions, go to the 'Subscription Swapping' section. Need more help?",
            "contact": "Our contact details are available in the Contact Us section below.",
            "buy": "For second-hand items, please visit the 'Second-Hand Buying' section.",
            "default": "I'm here to help with questions about renting, subscriptions, and second-hand items. Feel free to ask!"
        };

        function toggleChat() {
            const chatInterface = document.getElementById('chatInterface');
            chatInterface.style.display = chatInterface.style.display === 'none' ? 'flex' : 'none';

            // Toggle aria-expanded state for accessibility
            const chatButton = document.querySelector('.chat-icon');
            const isExpanded = chatInterface.style.display === 'flex';
            chatButton.setAttribute('aria-expanded', isExpanded);
        }

        function sendMessage() {
            const userInput = document.getElementById('userInput');
            const chatMessages = document.getElementById('chatMessages');
            const message = userInput.value.toLowerCase();

            // Add user message
            chatMessages.innerHTML += `
                <div class="message user-message">
                    ${userInput.value}
                </div>
            `;

            // Find response
            let response = predefinedResponses.default;
            for (const [keyword, reply] of Object.entries(predefinedResponses)) {
                if (message.includes(keyword)) {
                    response = reply;
                    break;
                }
            }

            // Add bot response after short delay
            setTimeout(() => {
                chatMessages.innerHTML += `
                    <div class="message bot-message">
                        ${response}
                    </div>
                `;
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 500);

            // Clear input
            userInput.value = '';
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Handle Enter key
        document.getElementById('userInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });
    </script>

</body>

</html>